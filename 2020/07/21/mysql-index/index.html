<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>MySQL性能优化-索引优化 | jas-wang的个人博客</title>
  <meta name="description" content="摘要   Mysql性能优化就算通过合理安排资源，调整系统参数使MYSQL运行更快，更节省资源。MYSQL性能优化包括查询速度优化，更新速度优化，mysql服务器优化等等。此处，介绍以下几个优化。包含，性能优化的介绍，查询优化，数据库结构优化，mysql服务器优化。 Mysql优化，一方面是找出系统的瓶颈，提高mysql数据库整体的性能，另外一个方面需要合理的结构设计和参数调整，以提高用户操作响应">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL性能优化-索引优化">
<meta property="og:url" content="http://jas-wang.fun/2020/07/21/mysql-index/index.html">
<meta property="og:site_name" content="1">
<meta property="og:description" content="摘要   Mysql性能优化就算通过合理安排资源，调整系统参数使MYSQL运行更快，更节省资源。MYSQL性能优化包括查询速度优化，更新速度优化，mysql服务器优化等等。此处，介绍以下几个优化。包含，性能优化的介绍，查询优化，数据库结构优化，mysql服务器优化。 Mysql优化，一方面是找出系统的瓶颈，提高mysql数据库整体的性能，另外一个方面需要合理的结构设计和参数调整，以提高用户操作响应">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-07-21T01:00:46.000Z">
<meta property="article:modified_time" content="2020-07-21T01:56:51.987Z">
<meta property="article:author" content="Jas wang">
<meta property="article:tag" content="MySQL">
<meta property="article:tag" content="性能优化">
<meta property="article:tag" content="索引优化，SQL优化">
<meta name="twitter:card" content="summary">
  <!-- Canonical links -->
  <link rel="canonical" href="http://jas-wang.fun/2020/07/21/mysql-index/index.html">
  
    <link rel="alternate" href="/atom.xml" title="1" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 4.2.1"></head>


<body class="main-center" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="" target="_blank">
          <img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">jas-wang</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md"></h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> chengdu, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">时间轴</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">标签</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">关于</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/jas-wang" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>欢迎交流与分享经验!</p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/MySQL/">MySQL</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/PHP/">PHP</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签</h3>
    <div class="widget-body">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/" rel="tag">PHP学习路线</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/" rel="tag">mysql</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/" rel="tag">php</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php%E5%BA%95%E5%B1%82%E4%BC%98%E5%8C%96/" rel="tag">php底层优化</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" rel="tag">性能优化</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/" rel="tag">性能分析工具</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BB%93%E6%9E%84%E4%BC%98%E5%8C%96/" rel="tag">数据库结构优化</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96%EF%BC%8CSQL%E4%BC%98%E5%8C%96/" rel="tag">索引优化，SQL优化</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%AB%98%E5%B9%B6%E5%8F%91/" rel="tag">高并发</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签云</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/MySQL/" style="font-size: 14px;">MySQL</a> <a href="/tags/PHP%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/" style="font-size: 13px;">PHP学习路线</a> <a href="/tags/mysql/" style="font-size: 13px;">mysql</a> <a href="/tags/php/" style="font-size: 14px;">php</a> <a href="/tags/php%E5%BA%95%E5%B1%82%E4%BC%98%E5%8C%96/" style="font-size: 13px;">php底层优化</a> <a href="/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" style="font-size: 14px;">性能优化</a> <a href="/tags/%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/" style="font-size: 13px;">性能分析工具</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BB%93%E6%9E%84%E4%BC%98%E5%8C%96/" style="font-size: 13px;">数据库结构优化</a> <a href="/tags/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96%EF%BC%8CSQL%E4%BC%98%E5%8C%96/" style="font-size: 13px;">索引优化，SQL优化</a> <a href="/tags/%E9%AB%98%E5%B9%B6%E5%8F%91/" style="font-size: 13px;">高并发</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">时间轴</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a><span class="archive-list-count">6</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled ">
        
          <li>
            
            <div class="item-thumb">
              <a href="/2020/07/21/mysql-strcut/" class="thumb">
    
    
        <span class="thumb-image thumb-none"></span>
    
</a>

            </div>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/MySQL/">MySQL</a>
              </p>
              <p class="item-title">
                <a href="/2020/07/21/mysql-strcut/" class="title">MySQL性能优化-数据库结构优化</a>
              </p>
              <p class="item-date">
                <time datetime="2020-07-21T02:00:46.000Z" itemprop="datePublished">2020-07-21</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-thumb">
              <a href="/2020/07/21/mysql-index/" class="thumb">
    
    
        <span class="thumb-image thumb-none"></span>
    
</a>

            </div>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/MySQL/">MySQL</a>
              </p>
              <p class="item-title">
                <a href="/2020/07/21/mysql-index/" class="title">MySQL性能优化-索引优化</a>
              </p>
              <p class="item-date">
                <time datetime="2020-07-21T01:00:46.000Z" itemprop="datePublished">2020-07-21</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-thumb">
              <a href="/2020/07/20/php-xhprof/" class="thumb">
    
    
        <span class="thumb-image thumb-none"></span>
    
</a>

            </div>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/PHP/">PHP</a>
              </p>
              <p class="item-title">
                <a href="/2020/07/20/php-xhprof/" class="title">PHP性能分析工具——xhprof</a>
              </p>
              <p class="item-date">
                <time datetime="2020-07-20T01:52:46.000Z" itemprop="datePublished">2020-07-20</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-thumb">
              <a href="/2020/07/17/question/" class="thumb">
    
    
        <span class="thumb-image thumb-none"></span>
    
</a>

            </div>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/PHP/">PHP</a>
              </p>
              <p class="item-title">
                <a href="/2020/07/17/question/" class="title">常见问题以及解决办法【todo】</a>
              </p>
              <p class="item-date">
                <time datetime="2020-07-17T01:52:46.000Z" itemprop="datePublished">2020-07-17</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-thumb">
              <a href="/2020/07/15/route/" class="thumb">
    
    
        <span class="thumb-image thumb-none"></span>
    
</a>

            </div>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/PHP/">PHP</a>
              </p>
              <p class="item-title">
                <a href="/2020/07/15/route/" class="title">PHP技术学习路线</a>
              </p>
              <p class="item-date">
                <time datetime="2020-07-15T01:52:46.000Z" itemprop="datePublished">2020-07-15</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      <ol class="toc"><li class="toc-item toc-level-5"><a class="toc-link" href="#SQL以及索引优化"><span class="toc-number">1.</span> <span class="toc-text">SQL以及索引优化</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#慢查询日志分析工具-mysqldumpslow"><span class="toc-number">2.</span> <span class="toc-text">慢查询日志分析工具-mysqldumpslow</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLAIN简介"><span class="toc-number">3.</span> <span class="toc-text">EXPLAIN简介</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#通过explain我们可以获得以下信息："><span class="toc-number">4.</span> <span class="toc-text">通过explain我们可以获得以下信息：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#如何分析SQL查询explain返回各列的含义"><span class="toc-number">5.</span> <span class="toc-text">如何分析SQL查询explain返回各列的含义</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#extra列需要注意返回值"><span class="toc-number">6.</span> <span class="toc-text">extra列需要注意返回值</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#执行计划各字段详细含义"><span class="toc-number">7.</span> <span class="toc-text">执行计划各字段详细含义</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#索引不足之处"><span class="toc-number">8.</span> <span class="toc-text">索引不足之处</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#索引简介"><span class="toc-number">9.</span> <span class="toc-text">索引简介</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#例子"><span class="toc-number">10.</span> <span class="toc-text">例子</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#索引使用注意事项"><span class="toc-number">11.</span> <span class="toc-text">索引使用注意事项</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#COUNT-和-MAX优化"><span class="toc-number">12.</span> <span class="toc-text">COUNT 和 MAX优化</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#子查询优化"><span class="toc-number">13.</span> <span class="toc-text">子查询优化</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Group-By-优化"><span class="toc-number">14.</span> <span class="toc-text">Group By 优化</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#LIMIT-查询优化"><span class="toc-number">15.</span> <span class="toc-text">LIMIT 查询优化</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#如何选择合适的列建立索引"><span class="toc-number">16.</span> <span class="toc-text">如何选择合适的列建立索引</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#问：应该建立-index-staff-id-customer-id-还是-index-customer-id-stuff-id-好-？"><span class="toc-number">17.</span> <span class="toc-text">问：应该建立 index(staff_id,customer_id) 还是 index(customer_id,stuff_id) 好 ？</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#索引优化SQL方法"><span class="toc-number">18.</span> <span class="toc-text">索引优化SQL方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#索引的维护以及优化–查找重复以及冗余索引"><span class="toc-number">19.</span> <span class="toc-text">索引的维护以及优化–查找重复以及冗余索引</span></a></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-mysql-index" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      MySQL性能优化-索引优化
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2020/07/21/mysql-index/" class="article-date">
	  <time datetime="2020-07-21T01:00:46.000Z" itemprop="datePublished">2020-07-21</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/MySQL/">MySQL</a>
  </span>

        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link" href="/tags/MySQL/" rel="tag">MySQL</a>, <a class="article-tag-link" href="/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" rel="tag">性能优化</a>, <a class="article-tag-link" href="/tags/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96%EF%BC%8CSQL%E4%BC%98%E5%8C%96/" rel="tag">索引优化，SQL优化</a>
  </span>


        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill" aria-hidden="true"></i>
	    <span id="busuanzi_container_page_pv">
			<span id="busuanzi_value_page_pv">0</span>
		</span>
	</span>


	<span class="article-read hidden-xs">
    	<i class="icon icon-eye-fill" aria-hidden="true"></i>
    	<span id="/2020/07/21/mysql-index/" class="leancloud_visitors"  data-flag-title="MySQL性能优化-索引优化">
			<span class="leancloud-visitors-count">0</span>
		</span>
    </span>

        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2020/07/21/mysql-index/#comments" class="article-comment-link">评论</a></span>
        
	
		<span class="post-wordcount hidden-xs" itemprop="wordCount">字数统计: 3.7k(字)</span>
	
	
		<span class="post-readcount hidden-xs" itemprop="timeRequired">阅读时长: 14(分)</span>
	

      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <p>摘要 </p>
<ul>
<li>Mysql性能优化就算通过合理安排资源，调整系统参数使MYSQL运行更快，更节省资源。MYSQL性能优化包括查询速度优化，更新速度优化，mysql服务器优化等等。此处，介绍以下几个优化。包含，性能优化的介绍，查询优化，数据库结构优化，mysql服务器优化。</li>
<li>Mysql优化，一方面是找出系统的瓶颈，提高mysql数据库整体的性能，另外一个方面需要合理的结构设计和参数调整，以提高用户操作响应的速度。同时还要尽可能节省系统资源，以便系统可以提供更大负荷的服务。mysql数据库优化是多方面的，原则是减少系统的瓶颈，减少资源的占用，增加系统反应的速度。</li>
</ul>
<hr>
<h5 id="SQL以及索引优化"><a href="#SQL以及索引优化" class="headerlink" title="SQL以及索引优化"></a>SQL以及索引优化</h5><ul>
<li>如何发现有问题的sql？</li>
<li>使用MYSQL慢查日志对有效率问题的SQL进行监控<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SHOW VARIABLES LIKE &#39;%log%&#39;;</span><br><span class="line">SET  GLOBAL slow_query_log &#x3D; ON;&#x2F;&#x2F;开启慢查询日志</span><br><span class="line">SHOW VARIABLES LIKE &#39;%slow_query_log%&#39;;</span><br><span class="line">SET  GLOBAL log_queries_not_using_indexes&#x3D;On; &#x2F;&#x2F;是否记录索引 默认false</span><br><span class="line">SET  GLOBAL long_query_time &#x3D; 1;&#x2F;&#x2F;长查询</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="慢查询日志分析工具-mysqldumpslow"><a href="#慢查询日志分析工具-mysqldumpslow" class="headerlink" title="慢查询日志分析工具-mysqldumpslow"></a>慢查询日志分析工具-mysqldumpslow</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldumpslow -t 3 &#x2F;home&#x2F;mysql-slow.log</span><br></pre></td></tr></table></figure>
<h5 id="EXPLAIN简介"><a href="#EXPLAIN简介" class="headerlink" title="EXPLAIN简介"></a>EXPLAIN简介</h5><p> 使用EXPLAIN关键字可以模拟优化器执行SQL查询语句，从而知道MySQL是如何处理你的SQL语句的。分析你的查询语句或是表结构的性能瓶颈。 </p>
<h5 id="通过explain我们可以获得以下信息："><a href="#通过explain我们可以获得以下信息：" class="headerlink" title="通过explain我们可以获得以下信息："></a>通过explain我们可以获得以下信息：</h5><ul>
<li>表的读取顺序</li>
<li>数据读取操作的操作类型</li>
<li>哪些索引可以使用</li>
<li>哪些索引被实际使用</li>
<li>表之间的引用</li>
<li>每张表有多少行被优化器查询</li>
<li>使用explain查询SQL的执行计划</li>
</ul>
<h5 id="如何分析SQL查询explain返回各列的含义"><a href="#如何分析SQL查询explain返回各列的含义" class="headerlink" title="如何分析SQL查询explain返回各列的含义"></a>如何分析SQL查询explain返回各列的含义</h5><ul>
<li>table:显示这一行的数据是关于哪张表的</li>
<li>type:这是重要的列，显示连接使用了何种类型。从最好到最差的连接类型为const:常量查找 （比如id=1），eq_reg（范围查找），ref（连接查询），range（基于索引范围查找 如id&gt;1）,index（索引扫描）all（表扫描）</li>
<li>possible_keys:显示可能应用在这张表中的索引。如果为空，没有可能 的索引。</li>
<li>key:实际使用的索引。如果为null，则没有使用索引。</li>
<li>ken_len：使用的所有长度。在不损失精确性的情况下，长度越短越好(因为mysql每次读取都是以列为单位的，所以索引的数量越大查询效率越慢)</li>
<li>ref:显示索引的哪一列被使用了，如果可能的话是一个常数</li>
<li>rows:返回请求的数据的行数</li>
</ul>
<h5 id="extra列需要注意返回值"><a href="#extra列需要注意返回值" class="headerlink" title="extra列需要注意返回值"></a>extra列需要注意返回值</h5><ul>
<li>Using filesort ：看到这个的时候，查询就需要优化了。MYSQL需要进行额外的步骤来发现如何对返回的行排序。他根据连接类型以及存储排序键值和匹配条件的全部行指针来排序全部行</li>
<li>Using temporary：查询需要优化。这里mysql需要创建一个临时表来存储结果，这通常发生在对不同的列集进行ORDER BY.,GROUP BY 上</li>
</ul>
<h5 id="执行计划各字段详细含义"><a href="#执行计划各字段详细含义" class="headerlink" title="执行计划各字段详细含义"></a>执行计划各字段详细含义</h5><ul>
<li><p>id<br> id相同，执行顺序由上至下<br> id不同，如果是子查询，id的序号会递增，id值越大优先级越高，越先被执行(比如子查询)<br> id相同不同，同时存在  id相同的可以认为是一组，同一组中从上往下执行，所有组中id大的优先执行</p>
</li>
<li><p>type所显示的是查询使用了哪种类型，type包含的类型包括如下图所示的几种，从好到差依次是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">-- system &gt; const &gt; eq_ref &gt; ref &gt; range &gt; index &gt; all</span><br><span class="line">-- system 表只有一行记录（等于系统表），这是const类型的特列，平时不会出现，这个也可以忽略不计</span><br><span class="line">-- const 表示通过索引一次就找到了，const用于比较primary key 或者unique索引。因为只匹配一行数据，所以很快。</span><br><span class="line">如将主键置于where列表中，MySQL就能将该查询转换为一个常量。 </span><br><span class="line">-- eq_ref 唯一性索引扫描，对于每个索引键，表中只有一条记录与之匹配。常见于主键或唯一索引扫描</span><br><span class="line">-- ref 非唯一性索引扫描，返回匹配某个单独值的所有行，本质上也是一种索引访问，它返回所有匹配某个单独值的行，</span><br><span class="line">然而，它可能会找到多个符合条件的行，所以他应该属于查找和扫描的混合体。</span><br><span class="line">-- range 只检索给定范围的行，使用一个索引来选择行，key列显示使用了哪个索引，一般就是在你的where语句中出现</span><br><span class="line">between、&lt; 、&gt;、in等的查询，这种范围扫描索引比全表扫描要好，因为它只需要开始于索引的某一点，而结束于另一点，不用扫描全部索引。</span><br><span class="line">-- index   Full Index Scan，Index与All区别为index类型只遍历索引树。这通常比ALL快，因为索引文件通常比数据文件小。</span><br><span class="line">（也就是说虽然all和Index都是读全表，但index是从索引中读取的，而all是从硬盘读取的） </span><br><span class="line">-- all   Full Table Scan 将遍历全表以找到匹配的行</span><br></pre></td></tr></table></figure>
</li>
<li><p>possible_keys 和 key<br>possible_keys 显示可能应用在这张表中的索引，一个或多个。查询涉及到的字段上若存在索引，则该索引将被列出，但不一定被查询实际使用。<br>key实际使用的索引，如果为NULL，则没有使用索引。（可能原因包括没有建立索引或索引失效） </p>
</li>
<li><p>key_len<br>表示索引中使用的字节数，可通过该列计算查询中使用的索引的长度，在不损失精确性的情况下，长度越短越好。</p>
</li>
<li><p>rows<br>根据表统计信息及索引选用情况，大致估算出找到所需的记录所需要读取的行数，也就是说，用的越少越好 </p>
</li>
<li><p>Extra</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">--  Using filesort</span><br><span class="line">说明mysql会对数据使用一个外部的索引排序，而不是按照表内的索引顺序进行读取。MySQL中无法利用索引完成的排序操作称为“文件排序”。</span><br><span class="line">--  Using temporary</span><br><span class="line">使用了用临时表保存中间结果，MySQL在对查询结果排序时使用临时表。常见于排序order by和分组查询group by。 </span><br><span class="line">--  Using index</span><br><span class="line">表示相应的select操作中使用了覆盖索引（Covering Index），避免访问了表的数据行，效率不错。如果同时出现using where，</span><br><span class="line">表明索引被用来执行索引键值的查找；如果没有同时出现using where，表明索引用来读取数据而非执行查找动作。</span><br><span class="line">-- Using join buffer</span><br><span class="line">表明使用了连接缓存,比如说在查询的时候，多表join的次数非常多，那么将配置文件中的缓冲区的join buffer调大一些。</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="索引不足之处"><a href="#索引不足之处" class="headerlink" title="索引不足之处"></a>索引不足之处</h5><ul>
<li><p>索引提高了查询的速度，但是降低了INSERT、UPDATE、DELETE的速度，因为在插入、修改、删除数据时，还要同时操作一下索引文件；</p>
</li>
<li><p>建立索引未见会占用一定的磁盘空间。</p>
</li>
</ul>
<h5 id="索引简介"><a href="#索引简介" class="headerlink" title="索引简介"></a>索引简介</h5><ul>
<li>数据库的索引就像一本书的目录，能够加快数据库的查询速度。</li>
<li>MYSQL索引有四种PRIMARY、INDEX、UNIQUE、FULLTEXT， 其中PRIMARY、INDEX、UNIQUE是一类，FULLTEXT是一类。</li>
<li>这四种都是单列索引，也就是他们都是作用于单个一列，所以也称单列索引；但是所以一个索引也可以作用于多个列上，称为组合索引或复合索引</li>
</ul>
<h5 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h5><p>主键索引 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">*RIMARY：主键索引。索引列唯一且不能为空；一张表只能有一个主键索引（主键索引通常在建表的时候就指定）</span><br><span class="line">CREATE TABLE T_USER(ID INT NOT NULL,USERNAME VARCHAR(16) NOT NULL,PRIMARY KEY(ID))</span><br><span class="line">*NORMAL：普通。索引列没有任何限制</span><br><span class="line">CREATE TABLE T_USER(ID INT NOT NULL,USERNAME VARCHAR(16) NOT NULL,INDEX USERNAME_INDEX(USERNAME(16))) </span><br><span class="line">* ALTER语句指定</span><br><span class="line">ALTER TABLE T_USER ADD INDEX U_INDEX (USERNAME) &#x2F;&#x2F;给列USERNAME建普通索引 U_INDEX</span><br><span class="line">* 删除索引</span><br><span class="line">DROP INDEX U_INDEX ON t_user &#x2F;&#x2F;删除表t_user中的索引U_INDEX</span><br></pre></td></tr></table></figure>

<p>唯一索引</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">UNIQUE：唯一索引。索引列的值必须是唯一的，但允许有空；</span><br><span class="line">* 建表时指定</span><br><span class="line">CREATE TABLE t_user(ID INT NOT NULL,USERNAME VARCHAR(16) NOT NULL,UNIQUE U_INDEX(USERNAME)) &#x2F;&#x2F;给列USERNAME添加唯一索引T_USER</span><br><span class="line">* ALTER语句指定</span><br><span class="line">ALTER TABLE t_user ADD UNIQUE u_index(USERNAME) &#x2F;&#x2F;给列T_USER添加唯一索引u_index</span><br><span class="line">* 删除索引</span><br><span class="line">DROP INDEX U_INDEX ON t_user</span><br></pre></td></tr></table></figure>
<p>全文索引</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FULLTEXT：全文搜索的索引。FULLTEXT 用于搜索很长一篇文章的时候，效果最好。用在比较短的文本，</span><br><span class="line">如果就一两行字的，普通的 INDEX 也可以。索引的新建和删除和上面一致，这里不再列举...</span><br></pre></td></tr></table></figure>
<p>组合索引（复合索引）　　</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">新建一张表</span><br><span class="line">CREATE TABLE T_USER(ID INT NOT NULL,USERNAME VARCHAR(16) NOT NULL,CITY VARCHAR(10),PHONE VARCHAR(10),PRIMARY KEY(ID) )</span><br><span class="line"></span><br><span class="line">组合索引就是把多个列加入到统一个索引中，如新建的表T_USER，我们给USERNAME+CITY+PHONE创建一个组合索引</span><br><span class="line">ALTER TABLE t_user ADD INDEX name_city_phone(USERNAME,CITY,PHONE) &#x2F;&#x2F;组合普通索引</span><br><span class="line"></span><br><span class="line">ALTER TABLE t_user ADD UNIQUE name_city_phone(USERNAME,CITY,PHONE) &#x2F;&#x2F;组合唯一索引</span><br></pre></td></tr></table></figure>
<p>这样的组合索引，其实相当于分别建立了（USERANME,CITY,PHONE   USERNAME,CITY   USERNAME,PHONE）三个索引。<br>为什么没有（CITY,PHONE）索引呢？这是因为MYSQL组合查询“最左前缀”的结果。简单的理解就是只从最左边开始组合。<br>并不是查询语句包含这三列就会用到该组合索引：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">这样的查询语句才会用到创建的组合索引</span><br><span class="line">SELECT * FROM t_user where USERNAME&#x3D;&quot;parry&quot; and CITY&#x3D;&quot;广州&quot; and PHONE&#x3D;&quot;180&quot;</span><br><span class="line">SELECT * FROM t_user where USERNAME&#x3D;&quot;parry&quot; and CITY&#x3D;&quot;广州&quot;</span><br><span class="line">SELECT * FROM t_user where USERNAME&#x3D;&quot;parry&quot; and PHONE&#x3D;&quot;180&quot;</span><br><span class="line"></span><br><span class="line">这样的查询语句是不会用到创建的组合索引　</span><br><span class="line">SELECT * FROM t_user where CITY&#x3D;&quot;广州&quot; and PHONE&#x3D;&quot;180&quot;</span><br><span class="line">SELECT * FROM t_user where CITY&#x3D;&quot;广州&quot;</span><br><span class="line">SELECT * FROM t_user where PHONE&#x3D;&quot;180&quot;</span><br></pre></td></tr></table></figure>

<h5 id="索引使用注意事项"><a href="#索引使用注意事项" class="headerlink" title="索引使用注意事项"></a>索引使用注意事项</h5><ul>
<li>只要列中包含NULL值将不会被包含在索引中，组合索引只要有一列含有NULL值，那么这一列对于组合索引就是无效的，<br>所以我们在设计数据库的时候最好不要让字段的默认值为NULL;</li>
<li>使用短索引</li>
<li>如果可能应该给索引指定一个长度，例如：一个VARCHAR(255)的列，但真实储存的数据只有20位的话，在创建索引时应指定索引的<br>长度为20，而不是默认不写。如下</li>
</ul>
<p><code>ALTER TABLE t_user add INDEX U_INDEX(USERNAME(16)) 优于 ALTER TABLE t_user add INDEX U_INDEX(USERNAME)</code></p>
<ul>
<li><p>使用短索引不仅能够提高查询速度，而且能节省磁盘操作以及I/O操作。</p>
</li>
<li><p>索引列排序<br>　　　Mysql在查询的时候只会使用一个索引，因此如果where子句已经使用了索引的话，那么order by中的列是不会使用索引的，所以order by尽量不要包含多个列的排序，如果非要多列排序，最好使用组合索引。</p>
</li>
<li><p>Like 语句<br>　　一般情况下不是鼓励使用like,如果非使用，那么需要注意 like”%aaa%”不会使用索引；但like“aaa%”会使用索引。</p>
</li>
<li><p>不使用 NOT IN和&lt;&gt;操作</p>
</li>
<li><p>索引方式 HASH和 BTREE比较</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">　HASH :　用于对等比较，如&quot;&#x3D;&quot;和&quot; &lt;&#x3D;&gt;&quot;</span><br><span class="line">　BTREE:　BTREE索引看名字就知道索引以树形结构存储，通常用在像 &quot;&#x3D;，&gt;，&gt;&#x3D;，&lt;，&lt;&#x3D;、BETWEEN、Like&quot;等操作符查询效率较高；</span><br></pre></td></tr></table></figure>

<p>通过比较发现，我们常用的是BTREE索引方式，当然Mysql默认就是BTREE方式。</p>
</li>
</ul>
<h5 id="COUNT-和-MAX优化"><a href="#COUNT-和-MAX优化" class="headerlink" title="COUNT 和 MAX优化"></a>COUNT 和 MAX优化</h5><ul>
<li>max   ：select max(update_time) from ps_table ;  会全表扫描，直接 将 update_time 设置索引</li>
<li>count : count(id)和count(<em>) 可能统计数量有差别 ，count（</em>） 包含null 的数量</li>
</ul>
<h5 id="子查询优化"><a href="#子查询优化" class="headerlink" title="子查询优化"></a>子查询优化</h5><p> 通常情况下，需要把子查询优化为join 查询，优化时需要注意一对多关系，要注意重复数据（可以使用 distinct 优化）</p>
<h5 id="Group-By-优化"><a href="#Group-By-优化" class="headerlink" title="Group By 优化"></a>Group By 优化</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">优化前：</span><br><span class="line">EXPLAIN SELECT a.first_name,a.last_name, COUNT(*) FROM film_actor fa INNER JOIN actor a USING (actor_id)</span><br><span class="line">GROUP BY  fa.actor_id;</span><br><span class="line"></span><br><span class="line">优化后：</span><br><span class="line">EXPLAIN SELECT a.first_name, a.last_name, COUNT(*) FROM  actor a INNER JOIN film_actor fa USING (actor_id)</span><br><span class="line">GROUP BY  a.actor_id;</span><br></pre></td></tr></table></figure>

<h5 id="LIMIT-查询优化"><a href="#LIMIT-查询优化" class="headerlink" title="LIMIT 查询优化"></a>LIMIT 查询优化</h5><p>   LIMIT常常用于分页处理，时常会伴随order by 从句使用，因此大多时候会使用filesort文件排序的方式，这样会造成大量IO问题</p>
<ul>
<li>情况1：由于title 排序字段没有建立索引，所以排序使用了文件排序 造成大量io</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN SELECT film_id,description from film ORDER BY title LIMIT 50,5;</span><br></pre></td></tr></table></figure>

<ul>
<li>情况2：排序字段加上 film_id 使用了索引，但是当数据量大（分页越到后面）的时候 也会扫描大量数据</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN SELECT film_id,description from film ORDER BY film_id LIMIT 50,5;</span><br></pre></td></tr></table></figure>

<ul>
<li>情况3：使用范围 where  （主键必须顺序增长）或者建立一个索引自增的列保持自增</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN SELECT film_id,description from film WHERE film_id &gt;  55 AND film_id &lt; 60  ORDER BY film_id LIMIT 1,5;</span><br></pre></td></tr></table></figure>

<p>优化思路：避免查询过多数据</p>
<h5 id="如何选择合适的列建立索引"><a href="#如何选择合适的列建立索引" class="headerlink" title="如何选择合适的列建立索引"></a>如何选择合适的列建立索引</h5><ul>
<li>在where从句，group by 从句 order by 从句，on 从句出现的列</li>
<li>索引字段越小越好 （数据库中数据存储单位是列为单位的，数据量存储越大 io消耗越高）</li>
<li>离散度大的列放到联合索引的前面（唯一值越多，可选择性越多）<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from  payment  where staff_id &#x3D; 2 and customer_id&#x3D;584;</span><br><span class="line">SELECT  COUNT(DISTINCT customer_id),COUNT(DISTINCT staff_id) from payment;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="问：应该建立-index-staff-id-customer-id-还是-index-customer-id-stuff-id-好-？"><a href="#问：应该建立-index-staff-id-customer-id-还是-index-customer-id-stuff-id-好-？" class="headerlink" title="问：应该建立 index(staff_id,customer_id) 还是 index(customer_id,stuff_id) 好 ？"></a>问：应该建立 index(staff_id,customer_id) 还是 index(customer_id,stuff_id) 好 ？</h5><p>答：由于 customer_id 唯一值 越多，可选择性越多 所以放在最前面 customer_id 的离散度更大，所以应该使用 index(customer_id,stuff_id)</p>
<h5 id="索引优化SQL方法"><a href="#索引优化SQL方法" class="headerlink" title="索引优化SQL方法"></a>索引优化SQL方法</h5><p>查询数据库冗余索引</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    a.TABLE_SCHEMA, a.INDEX_NAME, b.INDEX_NAME, a.COLUMN_NAME</span><br><span class="line">FROM</span><br><span class="line">    STATISTICS a</span><br><span class="line">JOIN STATISTICS b ON a.TABLE_SCHEMA &#x3D; b.TABLE_SCHEMA</span><br><span class="line">AND a.TABLE_NAME &#x3D; b.TABLE_NAME AND a.SEQ_IN_INDEX &#x3D; b.SEQ_IN_INDEX</span><br><span class="line">AND a.COLUMN_NAME &#x3D; b.COLUMN_NAME</span><br><span class="line">WHERE a.SEQ_IN_INDEX &#x3D; 1 AND a.INDEX_NAME &lt;&gt; b.INDEX_NAME</span><br></pre></td></tr></table></figure>

<h5 id="索引的维护以及优化–查找重复以及冗余索引"><a href="#索引的维护以及优化–查找重复以及冗余索引" class="headerlink" title="索引的维护以及优化–查找重复以及冗余索引"></a>索引的维护以及优化–查找重复以及冗余索引</h5><p>MYSQL 目前只能通过慢查询日志配合pt-index-usage工具来进行索引使用情况分析两个工具</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pt-index-usage -uroot -p &#39;123456&#39; -h 127.0.0.1MYS （索引使用频率工具）</span><br><span class="line">pt-duplicate-key-checker -uroot -p &#39;123456&#39; -h 127.0.0.1MYS （索引重复以及冗余索引工具）</span><br></pre></td></tr></table></figure>















      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://jas-wang.fun/2020/07/21/mysql-index/" title="MySQL性能优化-索引优化" target="_blank" rel="external">http://jas-wang.fun/2020/07/21/mysql-index/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="" target="_blank"><span class="text-dark">jas-wang</span><small class="ml-1x"></small></a></h3>
        <div>个人简介-PHP开发工程师</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="vcomments"></div>
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2020/07/21/mysql-strcut/" title="MySQL性能优化-数据库结构优化"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2020/07/20/php-xhprof/" title="PHP性能分析工具——xhprof"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">
        <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="wechat" data-mobile-sites="wechat"></div>
    
  </div>
  </div>
</nav>
  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>感谢您的支持，我会继续努力的!</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码打赏哦</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码打赏哦</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/jas-wang" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        &copy; 2020 Jas wang
        

    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





   
    
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine"></script>
  <script type="text/javascript">
  var GUEST = ['nick', 'mail', 'link'];
  var meta = 'nick,';
  meta = meta.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#vcomments',
    verify: false,
    notify: false,
    appId: 'imri2R91G786RLtoBoLoNgpW-gzGzoHsz',
    appKey: 'D80mEDDfE13OebIhFfhM4HCM',
    placeholder: '快来评论吧！',
    avatar: 'mm',
    meta: meta,
    pageSize: '10' || 10,
    visitor: true
  });
  </script>

     







</body>
</html>